{
	"name": "dedicatedSQL_pool",
	"properties": {
		"content": {
			"query": "\n-- before creating database scop cred , create database master key\nCREATE MASTER KEY ENCRYPTION BY\nPASSWORD = 'Ai@304491';\n\n----------------------------------------------------------------------------------------------------------------------------------------------------------\n--- before careating external data source , give credential to access data continer \nCREATE DATABASE SCOPED CREDENTIAL databasecred1\nWITH \nIDENTITY = 'SHARED ACCESS SIGNATURE',\nSECRET = 'sp=rl&st=2024-06-30T05:26:43Z&se=2024-06-30T13:26:43Z&spr=https&sv=2022-11-02&sr=c&sig=%2BB2VNKCkRFnGtbSKsAN%2FuACM04Xjki9nLd0nK5wOks0%3D'\n\n----------------------------------------------------\n-- create external data source with hadoop driver ( creating external table for dedicated sql pool)\n\nCREATE EXTERNAL DATA SOURCE externalsourcededicatedpool\nWITH(\n    LOCATION = 'abfss://csv@aa4491synapsstorage.dfs.core.windows.net',\n    TYPE = HADOOP,\n    CREDENTIAL = databasecred1\n);\n\n\n---------------------------------------------------------\n\n-- create external file formate for csv/parquet/json,etc,,,,.,\n\nCREATE EXTERNAL FILE FORMAT csvfileformate\nWITH(\n    FORMAT_TYPE = DELIMITEDTEXT,\n    FORMAT_OPTIONS(\n        FIELD_TERMINATOR = ',',\n        FIRST_ROW = 2 --first row as header\n    )\n);\n\n---------------------------------------\n\n\n\n-- creating external serverless table(Built-in serverless pool)\n\nCREATE EXTERNAL TABLE aravindlogdata\n(\n    [CorrelationId] NVARCHAR(36),\n    [OperationName] NVARCHAR(255),\n    [Status] NVARCHAR(50),\n    [EventCategory] NVARCHAR(50),\n    [Level] NVARCHAR(50),\n    [Time] DATETIME2,\n    [Subscription] NVARCHAR(50),\n    [EventInitiatedBy] NVARCHAR(255),\n    [ResourceType] NVARCHAR(255),\n    [ResourceGroup] NVARCHAR(255),\n    [Resource] NVARCHAR(500)\n)\nWITH(\n    LOCATION = 'Log.csv', --file name\n    DATA_SOURCE = externalsourcededicatedpool,\n    FILE_FORMAT = csvfileformate\n);\n\n---------------------------------------------------------------------\nSELECT * from aravindlogdata;\n\n\n-----------------------------------------------------------------------------\n\n--------------******* Use COPY command to create table ****************----------------\n\n-- Create the target table\nCREATE TABLE logdatacopy\n(\n    [CorrelationId] NVARCHAR(36),\n    [OperationName] NVARCHAR(255),\n    [Status] NVARCHAR(50),\n    [EventCategory] NVARCHAR(50),\n    [Level] NVARCHAR(50),\n    [Time] DATETIME2,\n    [Subscription] NVARCHAR(50),\n    [EventInitiatedBy] NVARCHAR(255),\n    [ResourceType] NVARCHAR(255),\n    [ResourceGroup] NVARCHAR(255),\n    [Resource] NVARCHAR(500)\n);\n\nCOPY INTO logdatacopy\nFROM 'https://aa4491synapsstorage.blob.core.windows.net/csv/Log.csv' \nWITH (\n    FILE_TYPE = 'CSV',\n    CREDENTIAL = (IDENTITY = 'SHARED ACCESS SIGNATURE', SECRET = 'sp=rl&st=2024-06-30T05:26:43Z&se=2024-06-30T13:26:43Z&spr=https&sv=2022-11-02&sr=c&sig=%2BB2VNKCkRFnGtbSKsAN%2FuACM04Xjki9nLd0nK5wOks0%3D'),\n    FIELDTERMINATOR = ',',\n    FIRSTROW = 2\n);\n\n---------------------------------------------------------------\n----------------------************ Use Polybase to create main table *****************----------------------\n\nCREATE TABLE logdatapolybase\nWITH\n(\n    DISTRIBUTION = ROUND_ROBIN\n)\nAS\nSELECT * from logdatacopy;\n\n------------------------------------------\n--------------****** create table using pipeline *************----------------------\n\n-- create a table schema \n-- use copydata activity under integrate session\nSELECT * from logdatapipeline;\n\n--------------------------------------------------------------------------------",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "dedicatedpool",
				"poolName": "dedicatedpool"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}